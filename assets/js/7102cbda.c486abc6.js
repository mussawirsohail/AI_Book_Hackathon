"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[675],{5158:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>d,contentTitle:()=>i,default:()=>u,frontMatter:()=>s,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"modules/module-5-rag-chatbot/lesson-2-authentication","title":"Lesson 2: Setting Up Authentication and User Profiles","description":"Introduction","source":"@site/docs/modules/module-5-rag-chatbot/lesson-2-authentication.md","sourceDirName":"modules/module-5-rag-chatbot","slug":"/modules/module-5-rag-chatbot/lesson-2-authentication","permalink":"/AI_Book_Hackathon/docs/modules/module-5-rag-chatbot/lesson-2-authentication","draft":false,"unlisted":false,"editUrl":"https://github.com/mussawirsohail/AI_Book_Hackathon/docs/modules/module-5-rag-chatbot/lesson-2-authentication.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2}}');var a=n(4848),o=n(8453);const s={sidebar_position:2},i="Lesson 2: Setting Up Authentication and User Profiles",d={},l=[{value:"Introduction",id:"introduction",level:2},{value:"Why Better Auth?",id:"why-better-auth",level:2},{value:"Installation and Setup",id:"installation-and-setup",level:2},{value:"Creating the User Registration Flow",id:"creating-the-user-registration-flow",level:2},{value:"Backend User Model with Background Information",id:"backend-user-model-with-background-information",level:2},{value:"Database Migration",id:"database-migration",level:2},{value:"Personalization Based on User Background",id:"personalization-based-on-user-background",level:2},{value:"Security Considerations",id:"security-considerations",level:2}];function c(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.header,{children:(0,a.jsx)(r.h1,{id:"lesson-2-setting-up-authentication-and-user-profiles",children:"Lesson 2: Setting Up Authentication and User Profiles"})}),"\n",(0,a.jsx)(r.h2,{id:"introduction",children:"Introduction"}),"\n",(0,a.jsx)(r.p,{children:"In this lesson, we'll implement the authentication system for our RAG chatbot using Better Auth. User authentication is crucial for tracking user interactions, personalizing content based on user background, and maintaining secure access to the chatbot."}),"\n",(0,a.jsx)(r.h2,{id:"why-better-auth",children:"Why Better Auth?"}),"\n",(0,a.jsx)(r.p,{children:"Better Auth is a modern authentication library that provides:"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"Easy integration with modern frameworks"}),"\n",(0,a.jsx)(r.li,{children:"Secure session management"}),"\n",(0,a.jsx)(r.li,{children:"Support for multiple authentication methods"}),"\n",(0,a.jsx)(r.li,{children:"TypeScript support"}),"\n",(0,a.jsx)(r.li,{children:"Database flexibility"}),"\n",(0,a.jsx)(r.li,{children:"Customizable user profiles"}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"installation-and-setup",children:"Installation and Setup"}),"\n",(0,a.jsx)(r.p,{children:"First, let's set up Better Auth in our project. For the backend, we'll create the necessary configuration:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-javascript",children:'// backend/auth/config.js\r\nimport { betterAuth } from "better-auth";\r\nimport { postgresAdapter } from "@better-auth/postgres-adapter";\r\nimport { neon } from "neon";\r\n\r\nconst client = neon(process.env.NEON_DATABASE_URL);\r\n\r\nexport const auth = betterAuth({\r\n  database: postgresAdapter(client, {\r\n    // Custom user schema to include background information\r\n    user: {\r\n      additionalFields: {\r\n        softwareBackground: {\r\n          type: "string",\r\n          required: true\r\n        },\r\n        hardwareBackground: {\r\n          type: "string",\r\n          required: true\r\n        }\r\n      }\r\n    }\r\n  }),\r\n  secret: process.env.AUTH_SECRET,\r\n  emailAndPassword: {\r\n    enabled: true\r\n  }\r\n});\n'})}),"\n",(0,a.jsx)(r.h2,{id:"creating-the-user-registration-flow",children:"Creating the User Registration Flow"}),"\n",(0,a.jsx)(r.p,{children:"The registration flow includes a survey to collect user background information, which will be used for content personalization:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-javascript",children:'// frontend/src/components/Auth/SignupForm.jsx\r\nimport React, { useState } from \'react\';\r\nimport { useForm } from \'react-hook-form\';\r\nimport { useAuth } from \'@better-auth/react\';\r\n\r\nconst SignupForm = () => {\r\n  const { registerUser } = useAuth();\r\n  const [background, setBackground] = useState({\r\n    softwareBackground: \'\',\r\n    hardwareBackground: \'\'\r\n  });\r\n\r\n  const { register, handleSubmit, formState: { errors } } = useForm();\r\n\r\n  const onSubmit = async (data) => {\r\n    try {\r\n      // Combine user data with background information\r\n      const userData = {\r\n        ...data,\r\n        ...background\r\n      };\r\n      \r\n      await registerUser(userData);\r\n    } catch (error) {\r\n      console.error(\'Registration error:\', error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit(onSubmit)} className="max-w-md mx-auto p-6 bg-white rounded-lg shadow-md">\r\n      <h2 className="text-2xl font-bold mb-6">Create Account</h2>\r\n      \r\n      <div className="mb-4">\r\n        <label className="block text-gray-700 text-sm font-bold mb-2" htmlFor="email">\r\n          Email\r\n        </label>\r\n        <input\r\n          {...register(\'email\', { required: \'Email is required\' })}\r\n          className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"\r\n          id="email"\r\n          type="email"\r\n        />\r\n        {errors.email && <p className="text-red-500 text-xs italic">{errors.email.message}</p>}\r\n      </div>\r\n      \r\n      <div className="mb-4">\r\n        <label className="block text-gray-700 text-sm font-bold mb-2" htmlFor="password">\r\n          Password\r\n        </label>\r\n        <input\r\n          {...register(\'password\', { \r\n            required: \'Password is required\',\r\n            minLength: {\r\n              value: 8,\r\n              message: \'Password must be at least 8 characters\'\r\n            }\r\n          })}\r\n          className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline"\r\n          id="password"\r\n          type="password"\r\n        />\r\n        {errors.password && <p className="text-red-500 text-xs italic">{errors.password.message}</p>}\r\n      </div>\r\n      \r\n      <div className="mb-6">\r\n        <label className="block text-gray-700 text-sm font-bold mb-2">\r\n          Software Background\r\n        </label>\r\n        <select\r\n          value={background.softwareBackground}\r\n          onChange={(e) => setBackground({...background, softwareBackground: e.target.value})}\r\n          className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"\r\n        >\r\n          <option value="">Select your software background</option>\r\n          <option value="beginner">Beginner</option>\r\n          <option value="intermediate">Intermediate</option>\r\n          <option value="advanced">Advanced</option>\r\n          <option value="expert">Expert</option>\r\n        </select>\r\n      </div>\r\n      \r\n      <div className="mb-6">\r\n        <label className="block text-gray-700 text-sm font-bold mb-2">\r\n          Hardware Background\r\n        </label>\r\n        <select\r\n          value={background.hardwareBackground}\r\n          onChange={(e) => setBackground({...background, hardwareBackground: e.target.value})}\r\n          className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"\r\n        >\r\n          <option value="">Select your hardware background</option>\r\n          <option value="beginner">Beginner</option>\r\n          <option value="intermediate">Intermediate</option>\r\n          <option value="advanced">Advanced</option>\r\n          <option value="expert">Expert</option>\r\n        </select>\r\n      </div>\r\n      \r\n      <div className="flex items-center justify-between">\r\n        <button\r\n          className="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"\r\n          type="submit"\r\n        >\r\n          Sign Up\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default SignupForm;\n'})}),"\n",(0,a.jsx)(r.h2,{id:"backend-user-model-with-background-information",children:"Backend User Model with Background Information"}),"\n",(0,a.jsx)(r.p,{children:"We need to extend our user model to store the software and hardware background information:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-python",children:'# backend/app/models/user.py\r\nfrom sqlmodel import SQLModel, Field\r\nfrom datetime import datetime\r\nfrom typing import Optional\r\n\r\nclass UserBase(SQLModel):\r\n    email: str = Field(unique=True, index=True)\r\n    name: Optional[str] = Field(default=None)\r\n\r\nclass User(UserBase, table=True):\r\n    id: Optional[int] = Field(default=None, primary_key=True)\r\n    hashed_password: str\r\n    software_background: str = Field(default="beginner")  # beginner, intermediate, advanced, expert\r\n    hardware_background: str = Field(default="beginner")  # beginner, intermediate, advanced, expert\r\n    is_active: bool = Field(default=True)\r\n    created_at: datetime = Field(default_factory=datetime.utcnow)\r\n    updated_at: datetime = Field(default_factory=datetime.utcnow)\r\n    \r\nclass UserCreate(UserBase):\r\n    password: str\r\n    software_background: str = "beginner"\r\n    hardware_background: str = "beginner"\r\n\r\nclass UserRead(UserBase):\r\n    id: int\r\n    software_background: str\r\n    hardware_background: str\r\n    created_at: datetime\n'})}),"\n",(0,a.jsx)(r.h2,{id:"database-migration",children:"Database Migration"}),"\n",(0,a.jsx)(r.p,{children:"We'll also need to create a database migration to add the background fields to our user table:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-python",children:"# backend/alembic/versions/xxx_add_background_fields_to_user.py\r\nfrom alembic import op\r\nimport sqlalchemy as sa\r\n\r\n# revision identifiers\r\nrevision = 'xxx'\r\ndown_revision = 'yyy'\r\nbranch_labels = None\r\ndepends_on = None\r\n\r\ndef upgrade():\r\n    # Add software_background column\r\n    op.add_column('user', sa.Column('software_background', sa.String(), nullable=True, server_default='beginner'))\r\n    \r\n    # Add hardware_background column\r\n    op.add_column('user', sa.Column('hardware_background', sa.String(), nullable=True, server_default='beginner'))\r\n    \r\n    # Update existing records to have default values\r\n    op.execute(\"UPDATE user SET software_background = 'beginner' WHERE software_background IS NULL\")\r\n    op.execute(\"UPDATE user SET hardware_background = 'beginner' WHERE hardware_background IS NULL\")\r\n    \r\n    # Alter columns to be non-nullable\r\n    op.alter_column('user', 'software_background', nullable=False)\r\n    op.alter_column('user', 'hardware_background', nullable=False)\r\n\r\ndef downgrade():\r\n    op.drop_column('user', 'hardware_background')\r\n    op.drop_column('user', 'software_background')\n"})}),"\n",(0,a.jsx)(r.h2,{id:"personalization-based-on-user-background",children:"Personalization Based on User Background"}),"\n",(0,a.jsx)(r.p,{children:"Once we have user background information, we can personalize the chatbot responses:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-python",children:'# backend/app/api/v1/chat.py\r\nfrom fastapi import APIRouter, Depends, HTTPException\r\nfrom sqlalchemy.ext.asyncio import AsyncSession\r\nfrom app.database import get_async_session\r\nfrom app.models.user import UserRead\r\nfrom app.api.deps import get_current_user\r\nimport logging\r\n\r\nrouter = APIRouter()\r\n\r\n@router.post("/chat")\r\nasync def chat_with_rag(\r\n    query: str,\r\n    session: AsyncSession = Depends(get_async_session),\r\n    current_user: UserRead = Depends(get_current_user)\r\n):\r\n    """\r\n    Chat endpoint that personalizes responses based on user background\r\n    """\r\n    try:\r\n        # Personalize the query based on user background\r\n        personalized_context = create_personalized_context(\r\n            query, \r\n            current_user.software_background, \r\n            current_user.hardware_background\r\n        )\r\n        \r\n        # Perform RAG operation with personalized context\r\n        response = await perform_rag_query(personalized_context)\r\n        \r\n        return {"response": response}\r\n    except Exception as e:\r\n        logging.error(f"Chat error: {e}")\r\n        raise HTTPException(status_code=500, detail="Internal server error")\r\n\r\ndef create_personalized_context(query: str, software_bg: str, hardware_bg: str):\r\n    """\r\n    Create personalized context based on user background\r\n    """\r\n    # Adjust the persona based on user\'s background\r\n    if software_bg == "beginner" or hardware_bg == "beginner":\r\n        persona = "Explain concepts in simple terms with practical examples."\r\n    elif software_bg == "expert" or hardware_bg == "expert":\r\n        persona = "Provide detailed technical explanations with advanced concepts."\r\n    else:\r\n        persona = "Provide balanced explanations with appropriate detail."\r\n    \r\n    return f"User Background: Software={software_bg}, Hardware={hardware_bg}. {persona} Query: {query}"\n'})}),"\n",(0,a.jsx)(r.h2,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,a.jsx)(r.p,{children:"When implementing the authentication system, we must consider several security aspects:"}),"\n",(0,a.jsxs)(r.ol,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.strong,{children:"Password Security"}),": Ensure passwords are properly hashed using strong algorithms"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.strong,{children:"Session Security"}),": Implement secure session management with appropriate expiration"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.strong,{children:"Data Protection"}),": Encrypt sensitive user data in the database"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.strong,{children:"Rate Limiting"}),": Prevent abuse of authentication endpoints"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.strong,{children:"Input Validation"}),": Validate all user inputs to prevent injection attacks"]}),"\n"]}),"\n",(0,a.jsxs)(r.p,{children:["Continue to ",(0,a.jsx)(r.a,{href:"/AI_Book_Hackathon/docs/modules/module-5-rag-chatbot/lesson-3-vector-database",children:"Lesson 3: Vector Database Setup with Qdrant"})," to learn how to set up the vector database for our RAG system."]})]})}function u(e={}){const{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>s,x:()=>i});var t=n(6540);const a={},o=t.createContext(a);function s(e){const r=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),t.createElement(o.Provider,{value:r},e.children)}}}]);